# Отчет по курсовому проекту
## по курсу "Логическое программирование"

### студент: Алексюнина Ю.В.

## Результат проверки

| Преподаватель     | Дата         |  Оценка       |
|-------------------|--------------|---------------|
| Сошников Д.В. |              |               |
| Левинская М.А.|              |               |

> *Комментарии проверяющих (обратите внимание, что более подробные комментарии возможны непосредственно в репозитории по тексту программы)*

## Введение

В ходе выполнения данного проекта я:

### 1. Узнаю больше о своей семье и познакомлюсь с сервисом MyHeritage.com
### 2. Усовершествую навыки написания парсеров, а также знание ЯП Python
### 3. Усовершенствую и закреплю знания по ЯП Prolog

## Задание

 1. Создать родословное дерево своего рода на несколько поколений (3-4) назад в стандартном формате GEDCOM с использованием сервиса MyHeritage.com 
 2. Преобразовать файл в формате GEDCOM в набор утверждений на языке Prolog, используя следующее представление: ...
 3. Реализовать предикат проверки/поиска .... 
 4. Реализовать программу на языке Prolog, которая позволит определять степень родства двух произвольных индивидуумов в дереве
 5. [На оценки хорошо и отлично] Реализовать естественно-языковый интерфейс к системе, позволяющий задавать вопросы относительно степеней родства, и получать осмысленные ответы. 

## Получение родословного дерева

Я зарегистрировалась на сервисе MyHeritage.com, создала своё генеалогическое древо и экспортировала его в формате *.ged 
К сожалению, всех родственников я не знаю, но надеюсь, что тех, которых я добавила, хватит для выполнения данного задания. Всего получилось 22 человека, включая меня.

## Конвертация родословного дерева

Для конвертации родословного дерева в набор утверждений на языке Prolog с использованием предикатов father(отец, потомок) и mother(мать, потомок) я использовала ЯП Python, поскольку он вполне удобен для парсинга и уже знаком мне.
Основная проблема заключалась в поиске определенных данных и сохранении их в соответствующих структурах с последующей записью в выходной файл. 

Алгоритм довольно прост и заключается в том, что, опираясь на некоторые ключевые слова из файла mytree.ged, мы "вытаскиваем" нужную нам информацию:

Читаем файл построчно. Сначала находим ID каждого индивидуума (если строчка заканчивается на "INDI\n", то в этой строчке есть ID), записываем его. 
Затем, с помощью ключевых слов "GIVN", "SURN" и "_MARNM" находим имя и фамилию каждого человека.
После этого записываем человека в список persons и ищем следующего.

Теперь аналогично, по ключевым словам, раскладывем людей по семьям(мама, папа, дети):
```python
fams = []
husb = ""
wife = ""
chil = []
for line in gedcom:
    word = line.split(' ')
    if word[1] == "HUSB":
        husb = word[2][:-1]
    if word[1] == "WIFE":
        wife = word[2][:-1]
    if word[1] == "CHIL":
        chil.append(word[2][:-1])
    if (len(word) > 2 and word[2] == "FAM\n" and (husb != '' or wife != '')):
        fams.append([husb, wife, chil])
        husb = ''
        wife = ''
        chil = []
```

Наконец, записываем полученные данные в результирующий файл в виде предикатов.

```python
prolog.write("%fathers\n")
fam = []
for fam in fams:
    if fam[0] != '':
        for child in fam[2]:
            prolog.write("father(" + str(getname(fam[0])) + ", " + str(getname(child)) + ").\n")
prolog.write("%mothers\n")
for fam in fams:
    if fam[1] != '':
        for child in fam[2]:
            prolog.write("mother(" + str(getname(fam[1])) + ", " + str(getname(child)) + ").\n")
prolog.close()
```
Исходный код парсера [здесь](pars.py)

## Предикат поиска родственника

Опишите, как устроен предикат поиска родственника, приведите его исходный код и примеры запросов/ответов (протокол работы).
Исходя из номера моего варианта, мне необходимо было реализовать предикат поиска шурина, то есть, брата жены.
Самое сложное было - понять, какие именно условия, опираясь на исходные данные, нужно записать, чтобы обеспечить верный ответ.

Реализация предиката:

```prolog
shurin(X,Y):-
    father(X, Child),
    Child \= "",
    mother(M, Child),
    mother(Gm, M),
    father(Gp, M),
    mother(Gm, Y),
    father(Gp, Y),
    father(Y, _).
```

Протокол работы:

```prolog
?-shurin(X,вячеслав_алексюнин).
X = григорий_волович


?-shurin(X,игорь_байрышевский).
X = григорий_волович

?-shurin(григорий_волович,Y).
Y = вячеслав_алексюнин
Y = игорь_байрышевский
```
## Выводы

Данная работа ведет к получению знаний сразу в нескольких сферах, каждая из которых требует внимания и должного труда: 
При написании эссе я лучше познакомилась с теоретической частью, поскольку мне необходимо было описать взаимодействия логического прогррамирования при создании современных информационных систем. 
При написании парсера мне надо было произвести некую контектенацию между различнвми языками: выполняя работу на одном языке, я подсознательно должна была предсатвлять, как это будет выглядеть на другом. 
При работе непостредственно с Прологом поняла, насколько разнозадачный это язык, он решает и логическую задачу, и способен строить некий диалог между пользователем и компьютером на уровне логики. 

На мой взгляд, это довольно интересная работа, одна из немногих, которые мне нужно было выполнять по учебе.
